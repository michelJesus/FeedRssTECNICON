<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Canal de Notícias</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <link rel="shortcut icon" href="images/favicon.ico" />
        <link rel="stylesheet" href="style/jquery.mobile-1.2.0.min.css" />
        <link rel="stylesheet" href="style/style.css" />
        <script src="js/jquery-1.8.2.min.js"></script>
        <script src="js/jquery-mobile/jquery.mobile-1.2.0.min.js"></script>
        <script type="text/javascript" src="js/jsapi.js"></script>

        <script type="text/javascript">

            google.load("feeds", "1");

            function initialize() {

                // Get feed.
                var feed = new google.feeds.Feed("http://www.tecnicon.com.br/index.php/blog?format=feed&type=rss");

                // Set the number of entries to get.
                feed.setNumEntries(4);

                // Load the feed.
                feed.load(function(result) {

                    // Get the content of page.
                    var $page = $("#tecblog");

                    // Delete the existing posts, if any.
                    $page.find(".content").empty();

                    // Verify error.
                    if (result.error) {
                        alert("Nenhum post encontrado.");
                    }else{

                        // Create a new list of posts.
                        $page.find(".content").html("<ul></ul>");

                        // Get list of posts.
                        $list = $page.find(".content ul");

                        // Get the content of feed.	
                        var container = document.getElementById("feed");

                        // Through the list of posts.
                        for (var count = 0; count < result.feed.entries.length; count++) {

                            // Get entry of feed.
                            var entry = result.feed.entries[count];

                            // Get title of post.
                            var title = entry.title;

                            // Get link of post.
                            var link = entry.link;

                            // Build HTML that contains the desired information.
                            var strLink = '<li><a href="javascript:create_page(' + count + ',\'' + title + '\');">';
                            strLink += title;
                            strLink += '</a></li>\n';

                            // Make it into a jQuery object.
                            var item = $(strLink);

                            // Append it to our list.
                            $list.append(item);
                        }
                        // Set list in listview.
                        $list.listview();
                    }
                });
            }
            google.setOnLoadCallback(initialize);

            function create_page(page_id, title) {

                // Get title.
                var titlePost = title;

                // Get feed.
                var feed = new google.feeds.Feed("http://www.tecnicon.com.br/index.php/blog?format=feed&type=rss");

                // Set the number of entries to get.
                feed.setNumEntries(10);

                // Load the feed.
                feed.load(function(result) {

                    // Get the content of page.
                    var $page = $("#tecblog");

                    // Delete the existing posts, if any.
                    $page.find(".content").empty();

                    // Verify error.
                    if (result.error) {
                        alert("Post não encontrado.");
                    }else{

                        // Through the list of posts.
                        for (var count = 0; count < result.feed.entries.length; count++) {

                            // Verify if title is equal.
                            if (titlePost == result.feed.entries[count].title){

                                // Get entry of feed.
                                var entry = result.feed.entries[page_id];

                                // Get title.
                                var title = entry.title;

                                // Get post.
                                var post = entry.content;

                                var strPost = '<div id="page_' + page_id + '" data-role="page">';
                                strPost += '<header data-role="header" data-position="fixed" data-theme="b">';
                                strPost += '<a data-role="button" data-direction="reverse" rel="external" href="tecblog.html" data-icon="arrow-l"  data-mini="true" data-iconpos="left">Voltar</a>';
                                strPost += '<a data-role="button" data-direction="reverse" rel="external" href="index.html" data-icon="home" data-mini="true" data-iconpos="right">Home</a>';
                                strPost += '<h1>TecBlog</h1></header>';
                                strPost += '<div class="contentPost" data-role="content">';
                                strPost += '<h3>' + title + '</h3>'
                                strPost += post + '</div>';
                                strPost += '<footer data-role="footer" data-position="" data-theme="b">';
                                strPost += '<h4><span class="copyright">Copyright © 2013 TECNICON Sistemas Gerenciais</span></h4>';

                                $('#page_body').append(strPost);

                                // initialize the new page 
                                $.mobile.initializePage();

                                // navigate to the new page
                                $.mobile.changePage("#page_" + page_id, "slide", true, false);
                            }
                        }
                    }
                });
            }
        </script>

    </head>
    <body id="page_body">
        <!-- begin home -->
        <div id="tecblog" data-role="page">
            <header data-role="header" data-position="fixed" data-theme="b">
                <h1>TecBlog</h1>
                <a data-role="button" data-direction="reverse"  
                   href="index.html" data-icon="arrow-l"  data-mini="true" data-iconpos="left">Voltar
                </a>
                <!--                <a data-role="button" data-direction="reverse" data-rel="home" 
                                   href="index.html" data-icon="home" data-mini="true" data-iconpos="right">Home
                                </a>-->
            </header>
            <div class="content" data-role="content" >
                <ul data-role="listview">
                </ul>
            </div>
            <footer data-role="footer" data-position="" data-theme="b">
                <h4><span class="copyright">Copyright © 2013 TECNICON Sistemas Gerenciais</span></h4>
            </footer>
        </div>
    </body>
</html>